group_by(US_region) %>%
summarise(n_rescinded = sum(covid_offers_rescinded)) %>%
per_US_region_rescinded <- full_join(offers_US_region, rescinded_US_region,
by = "US_region") %>%
mutate(n_rescinded = replace(n_rescinded, is.na(n_rescinded), 0),
percent_res = get_percent(n_rescinded, n_offers),
US_region = paste0(US_region, "\n(", n_rescinded, "/", n_offers, ")"),
r = paste0("r=", n_rescinded),
nr = n_offers - n_rescinded)
rescinded_US_region <- rescinded_df %>%
filter(!is.na(US_region)) %>%
group_by(US_region) %>%
summarise(n_rescinded = sum(covid_offers_rescinded))
per_US_region_rescinded <- full_join(offers_US_region, rescinded_US_region,
by = "US_region") %>%
mutate(n_rescinded = replace(n_rescinded, is.na(n_rescinded), 0),
percent_res = get_percent(n_rescinded, n_offers),
US_region = paste0(US_region, "\n(", n_rescinded, "/", n_offers, ")"),
r = paste0("r=", n_rescinded),
nr = n_offers - n_rescinded)
View(per_US_region_rescinded)
PUI_RI_rescinded %>%
ggplot(aes(x = PUI_RI, y = percent_res, fill = PUI_RI))+
geom_col()+
scale_fill_manual(values = cbPalette)
PUI_RI_rescinded %>%
ggplot(aes(x = PUI_RI, y = percent_res, fill = PUI_RI))+
geom_col()+
scale_fill_manual(values = cbPalette)+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), vjust = -1.25)+
geom_hline(yintercept = percent_rescinded, linetype="dashed", color = "black")
PUI_RI_rescinded %>%
ggplot(aes(x = PUI_RI, y = percent_res, fill = PUI_RI))+
geom_col()+
scale_fill_manual(values = cbPalette)+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), vjust = -1.25)+
geom_vline(yintercept = percent_rescinded, linetype="dashed", color = "black")
PUI_RI_rescinded %>%
ggplot(aes(x = PUI_RI, y = percent_res, fill = PUI_RI))+
geom_col()+
scale_fill_manual(values = cbPalette)+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), vjust = -1.25)+
geom_vline(xintercept = percent_rescinded, linetype="dashed", color = "black")
percent_rescinded_df[1,4] %>% as.vector()
percent_rescinded_df[1,4] %>% as.character()
percent_rescinded_df[1,4]
percent_rescinded <- percent_rescinded_df[1,4] %>% as.numeric()
PUI_RI_rescinded %>%
ggplot(aes(x = PUI_RI, y = percent_res, fill = PUI_RI))+
geom_col()+
scale_fill_manual(values = cbPalette)+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), vjust = -1.25)+
geom_vline(xintercept = percent_rescinded, linetype="dashed", color = "black")
PUI_RI_rescinded %>%
ggplot(aes(x = PUI_RI, y = percent_res, fill = PUI_RI))+
geom_col()+
scale_fill_manual(values = cbPalette)+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), vjust = -1.25)+
geom_hline(yintercept = percent_rescinded, linetype="dashed", color = "black")
PUI_RI_rescinded %>%
ggplot(aes(x = PUI_RI, y = percent_res, fill = PUI_RI))+
geom_col()+
scale_fill_manual(values = cbPalette)+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), vjust = -1.25)+
geom_hline(yintercept = percent_rescinded, linetype="dashed", color = "black")+
geom_text(aes(1, percent_rescinded+1, label = paste0(percent_rescinded, "%")),
color = "black")+
#coord_flip(ylim = c(0,50))+
#facet_wrap(~legal_status, ncol = 1, scales = "free_y")+
labs(y = "\nPercent of Offers Rescinded\n", x = "\nInstitution Type")+
scale_y_continuous(limits = c(0,20), expand = c(0,0))+
my_theme_horiz
PUI_RI_rescinded %>%
ggplot(aes(x = PUI_RI, y = percent_res, fill = PUI_RI))+
geom_col()+
scale_fill_manual(values = cbPalette)+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), vjust = -1.25)+
geom_hline(yintercept = percent_rescinded, linetype="dashed", color = "black")+
geom_text(aes(1, percent_rescinded+1, label = paste0(percent_rescinded, "%")),
color = "black")
PUI_RI_rescinded %>%
ggplot(aes(x = PUI_RI, y = percent_res, fill = PUI_RI))+
geom_col()+
scale_fill_manual(values = cbPalette)+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), vjust = -1.25)+
geom_hline(yintercept = percent_rescinded, linetype="dashed", color = "black")+
geom_text(aes(1, percent_rescinded+1, label = paste0(percent_rescinded, "%")),
color = "black")+
#coord_flip(ylim = c(0,50))+
#facet_wrap(~legal_status, ncol = 1, scales = "free_y")+
labs(y = "\nPercent of Offers Rescinded\n", x = "\nInstitution Type")+
#scale_y_continuous(limits = c(0,20), expand = c(0,0))+
my_theme_horiz
PUI_RI_rescinded %>%
ggplot(aes(x = PUI_RI, y = percent_res, fill = PUI_RI))+
geom_col()+
scale_fill_manual(values = cbPalette)+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), vjust = -1.25)+
geom_hline(yintercept = percent_rescinded, linetype="dashed", color = "black")+
geom_text(aes(1, percent_rescinded+3, label = paste0(percent_rescinded, "%")),
color = "black")+
#coord_flip(ylim = c(0,50))+
#facet_wrap(~legal_status, ncol = 1, scales = "free_y")+
labs(y = "\nPercent of Offers Rescinded\n", x = "\nInstitution Type")+
#scale_y_continuous(limits = c(0,20), expand = c(0,0))+
my_theme_horiz
per_US_region_rescinded %>%
ggplot(aes(x = US_region, y = percent_res, fill = US_region))+
geom_col()+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), hjust = -0.25)+
coord_flip()+
scale_fill_manual(values = cbPalette)+
geom_hline(yintercept = percent_rescinded, linetype="dashed", color = "black")+
geom_text(aes(2, percent_rescinded+1, label = paste0(round(percent_rescinded, 1), "%")),
color = "black")+
labs(y = "\nPercent of Offers Rescinded", x = "\nUS Region")+
#scale_y_continuous(limits = c(0,20), expand = c(0,0))+
my_theme_horiz+
right_margin
per_US_region_rescinded %>%
ggplot(aes(x = US_region, y = percent_res, fill = US_region))+
geom_col()+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), hjust = -0.25)+
coord_flip()+
scale_fill_manual(values = cbPalette)+
geom_hline(yintercept = percent_rescinded, linetype="dashed", color = "black")+
geom_text(aes(2, percent_rescinded+10, label = paste0(round(percent_rescinded, 1), "%")),
color = "black")+
labs(y = "\nPercent of Offers Rescinded", x = "\nUS Region")+
#scale_y_continuous(limits = c(0,20), expand = c(0,0))+
my_theme_horiz+
right_margin
fig2A_data %>%
ggplot(aes(x = adjusted_gender, y=percent_res,
fill = adjusted_gender))+
geom_col()+
coord_flip()+
scale_fill_manual(values = cbPalette)+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), hjust = -0.25)+
geom_hline(yintercept = overall_percent_rescinded,
linetype = "dashed", color = "black")+
geom_text(aes(1, overall_percent_rescinded+2,
label = paste0(round(overall_percent_rescinded, 1), "%")),
color = "black")+
labs(x = "\nReported Gender", y = "\nOverall Percent of Offers Rescinded")+
scale_y_continuous(limits = c(0,20), expand = c(0,0))+
my_theme_horiz+
right_margin
#Figure 2. The Pandemic begins, mid-interview portion of the Faculty Job Search
fig2_data <- res_demo_data %>%
filter(survey_year == "2019-2020")
# A/B. Offers Rescinded by field and gender----
# requires get_3yr_survey_results
fig2A_data <- get_plot_summary(fig2_data, "adjusted_gender",
"covid_offers_rescinded")
fig2A_data %>%
ggplot(aes(x = adjusted_gender, y=percent_res,
fill = adjusted_gender))+
geom_col()+
coord_flip()+
scale_fill_manual(values = cbPalette)+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), hjust = -0.25)+
geom_hline(yintercept = overall_percent_rescinded,
linetype = "dashed", color = "black")+
geom_text(aes(1, overall_percent_rescinded+2,
label = paste0(round(overall_percent_rescinded, 1), "%")),
color = "black")+
labs(x = "\nReported Gender", y = "\nOverall Percent of Offers Rescinded")+
scale_y_continuous(limits = c(0,20), expand = c(0,0))+
my_theme_horiz+
right_margin
get_plot_summary(data = fig2_data,
x = "research_category", y = "covid_offers_rescinded") %>%
ggplot(aes(x = research_category, y = percent_res, fill = research_category))+
geom_col()+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), hjust = -0.25)+
coord_flip()+
scale_fill_manual(values = cbPalette)+
geom_hline(yintercept = overall_percent_rescinded, linetype="dashed", color = "black")+
geom_text(aes(5, overall_percent_rescinded+3,
label = paste0(round(overall_percent_rescinded, 1), "%")),
color = "black")+
labs(y = "\nOverall Percent of Offers Rescinded", x = "\nReported Research Category")+
scale_y_continuous(limits = c(0,40), expand = c(0,0))+
my_theme
get_plot_summary(data = fig2_data,
x = "research_category", y = "covid_offers_rescinded") %>%
ggplot(aes(x = research_category, y = percent_res, fill = research_category))+
geom_col()+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), hjust = -0.25)+
coord_flip()+
scale_fill_manual(values = cbPalette)+
geom_hline(yintercept = overall_percent_rescinded, linetype="dashed", color = "black")+
geom_text(aes(5, overall_percent_rescinded+3,
label = paste0(round(overall_percent_rescinded, 1), "%")),
color = "black")+
labs(y = "\nOverall Percent of Offers Rescinded", x = "\nReported Research Category")+
scale_y_continuous(limits = c(0,20), expand = c(0,0))+
my_theme
get_plot_summary(data = fig2_data,
x = "research_category", y = "covid_offers_rescinded") %>%
ggplot(aes(x = research_category, y = percent_res, fill = research_category))+
geom_col()+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), hjust = -0.25)+
coord_flip()+
scale_fill_manual(values = cbPalette)+
geom_hline(yintercept = overall_percent_rescinded, linetype="dashed", color = "black")+
geom_text(aes(5, overall_percent_rescinded+3,
label = paste0(round(overall_percent_rescinded, 1), "%")),
color = "black")+
labs(y = "\nOverall Percent of Offers Rescinded", x = "\nReported Research Category")+
scale_y_continuous(limits = c(0,25), expand = c(0,0))+
my_theme
get_plot_summary(data = fig2_data,
x = "peer", y = "covid_offers_rescinded") %>%
ggplot(aes(x = fct_reorder(peer, desc(percent_res)), y = percent_res,
fill = peer))+
geom_col()+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), hjust = -0.25)+
coord_flip(ylim = c(0,50))+
scale_fill_manual(values = cbPalette)+
geom_hline(yintercept = overall_percent_rescinded, linetype="dashed", color = "black")+
geom_text(aes(3, overall_percent_rescinded+2.5,
label = paste0(round(overall_percent_rescinded, 1), "%")),
color = "black")+
#facet_wrap(~legal_status, ncol = 1, scales = "free_y")+
labs(y = "\nOverall Percent of Offers Rescinded", x = "\nPEER Status")+
scale_y_continuous(limits = c(0,25), expand = c(0,0))+
my_theme_horiz+
right_margin
get_plot_summary(data = fig2_data,
x = "peer", y = "covid_offers_rescinded") %>%
filter(peer != "NR") %>%
ggplot(aes(x = fct_reorder(peer, desc(percent_res)), y = percent_res,
fill = peer))+
geom_col()+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), hjust = -0.25)+
coord_flip(ylim = c(0,20))+
scale_fill_manual(values = cbPalette)+
geom_hline(yintercept = overall_percent_rescinded, linetype="dashed", color = "black")+
geom_text(aes(3, overall_percent_rescinded+2.5,
label = paste0(round(overall_percent_rescinded, 1), "%")),
color = "black")+
#facet_wrap(~legal_status, ncol = 1, scales = "free_y")+
labs(y = "\nOverall Percent of Offers Rescinded", x = "\nPEER Status")+
scale_y_continuous(expand = c(0,0))+
my_theme_horiz+
right_margin
get_plot_summary(data = fig2_data,
x = "peer", y = "covid_offers_rescinded")
get_plot_summary(data = fig2_data,
x = "peer", y = "covid_offers_rescinded") %>%
filter(peer != "NR (0/1)") %>%
ggplot(aes(x = fct_reorder(peer, desc(percent_res)), y = percent_res,
fill = peer))+
geom_col()+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), hjust = -0.25)+
coord_flip(ylim = c(0,20))+
scale_fill_manual(values = cbPalette)+
geom_hline(yintercept = overall_percent_rescinded, linetype="dashed", color = "black")+
geom_text(aes(3, overall_percent_rescinded+2.5,
label = paste0(round(overall_percent_rescinded, 1), "%")),
color = "black")+
#facet_wrap(~legal_status, ncol = 1, scales = "free_y")+
labs(y = "\nOverall Percent of Offers Rescinded", x = "\nPEER Status")+
scale_y_continuous(expand = c(0,0))+
my_theme_horiz+
right_margin
get_plot_summary(data = fig2_data,
x = "peer", y = "covid_offers_rescinded") %>%
filter(peer != "NR (0/1)") %>%
ggplot(aes(x = fct_reorder(peer, desc(percent_res)), y = percent_res,
fill = peer))+
geom_col()+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), hjust = -0.25)+
coord_flip(ylim = c(0,20))+
scale_fill_manual(values = cbPalette)+
geom_hline(yintercept = overall_percent_rescinded, linetype="dashed", color = "black")+
geom_text(aes(2, overall_percent_rescinded+2.5,
label = paste0(round(overall_percent_rescinded, 1), "%")),
color = "black")+
#facet_wrap(~legal_status, ncol = 1, scales = "free_y")+
labs(y = "\nOverall Percent of Offers Rescinded", x = "\nPEER Status")+
scale_y_continuous(expand = c(0,0))+
my_theme_horiz+
right_margin
get_plot_summary(data = fig2_data,
x = "peer", y = "covid_offers_rescinded") %>%
filter(peer != "NR (0/1)") %>%
ggplot(aes(x = fct_reorder(peer, desc(percent_res)), y = percent_res,
fill = peer))+
geom_col()+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), hjust = -0.25)+
coord_flip(ylim = c(0,20))+
scale_fill_manual(values = cbPalette)+
geom_hline(yintercept = overall_percent_rescinded, linetype="dashed", color = "black")+
geom_text(aes(2, overall_percent_rescinded+1.5,
label = paste0(round(overall_percent_rescinded, 1), "%")),
color = "black")+
#facet_wrap(~legal_status, ncol = 1, scales = "free_y")+
labs(y = "\nOverall Percent of Offers Rescinded", x = "\nPEER Status")+
scale_y_continuous(expand = c(0,0))+
my_theme_horiz+
right_margin
fig2ABC <- plot_grid(fig2A, fig2B, fig2C, labels = c('A', 'B', 'C'),
label_size = 18,
nrow = 1, rel_widths = c(.75, 1, 1))
fig2_data <- res_demo_data %>%
filter(survey_year == "2019-2020")
# A/B. Offers Rescinded by field and gender----
# requires get_3yr_survey_results
fig2A_data <- get_plot_summary(fig2_data, "adjusted_gender",
"covid_offers_rescinded")
fig2A <- fig2A_data %>%
ggplot(aes(x = adjusted_gender, y=percent_res,
fill = adjusted_gender))+
geom_col()+
coord_flip()+
scale_fill_manual(values = cbPalette)+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), hjust = -0.25)+
geom_hline(yintercept = overall_percent_rescinded,
linetype = "dashed", color = "black")+
geom_text(aes(1, overall_percent_rescinded+2,
label = paste0(round(overall_percent_rescinded, 1), "%")),
color = "black")+
labs(x = "\nReported Gender", y = "\nOverall Percent of Offers Rescinded")+
scale_y_continuous(limits = c(0,20), expand = c(0,0))+
my_theme_horiz+
right_margin
fig2B <- get_plot_summary(data = fig2_data,
x = "research_category", y = "covid_offers_rescinded") %>%
ggplot(aes(x = research_category, y = percent_res, fill = research_category))+
geom_col()+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), hjust = -0.25)+
coord_flip()+
scale_fill_manual(values = cbPalette)+
geom_hline(yintercept = overall_percent_rescinded, linetype="dashed", color = "black")+
geom_text(aes(5, overall_percent_rescinded+3,
label = paste0(round(overall_percent_rescinded, 1), "%")),
color = "black")+
labs(y = "\nOverall Percent of Offers Rescinded", x = "\nReported Research Category")+
scale_y_continuous(limits = c(0,25), expand = c(0,0))+
my_theme
# C. Offers rescinded by race/ethnicity----
fig2C <- get_plot_summary(data = fig2_data,
x = "peer", y = "covid_offers_rescinded") %>%
filter(peer != "NR (0/1)") %>%
ggplot(aes(x = fct_reorder(peer, desc(percent_res)), y = percent_res,
fill = peer))+
geom_col()+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), hjust = -0.25)+
coord_flip(ylim = c(0,20))+
scale_fill_manual(values = cbPalette)+
geom_hline(yintercept = overall_percent_rescinded, linetype="dashed", color = "black")+
geom_text(aes(2, overall_percent_rescinded+1.5,
label = paste0(round(overall_percent_rescinded, 1), "%")),
color = "black")+
#facet_wrap(~legal_status, ncol = 1, scales = "free_y")+
labs(y = "\nOverall Percent of Offers Rescinded", x = "\nPEER Status")+
scale_y_continuous(expand = c(0,0))+
my_theme_horiz+
right_margin
#get_rescinded_inst <- function(x, df){
#
#  #df <- rescinded_df
#
#  id_x <- as.numeric(x)
#
#  ea_id <- df %>% filter(id == id_x)
#
#  one_offer <- ea_id %>%
#    head(n = 1)
#
#  return(one_offer)
#}
#D. Compare the % of R1 vs PUI offers made vs offers rescinded----
fig2D <- PUI_RI_rescinded %>%
ggplot(aes(x = PUI_RI, y = percent_res, fill = PUI_RI))+
geom_col()+
scale_fill_manual(values = cbPalette)+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), vjust = -1.25)+
geom_hline(yintercept = percent_rescinded, linetype="dashed", color = "black")+
geom_text(aes(1, percent_rescinded+3, label = paste0(percent_rescinded, "%")),
color = "black")+
#coord_flip(ylim = c(0,50))+
#facet_wrap(~legal_status, ncol = 1, scales = "free_y")+
labs(y = "\nPercent of Offers Rescinded\n", x = "\nInstitution Type")+
#scale_y_continuous(limits = c(0,20), expand = c(0,0))+
my_theme_horiz
#map_df(.x = id_list,
#                   .f = get_rescinded_inst, rescinded_df)
#E. Compare US region of institutions applied to and the number of offers rescinded----
fig2E <- per_US_region_rescinded %>%
ggplot(aes(x = US_region, y = percent_res, fill = US_region))+
geom_col()+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), hjust = -0.25)+
coord_flip()+
scale_fill_manual(values = cbPalette)+
geom_hline(yintercept = percent_rescinded, linetype="dashed", color = "black")+
geom_text(aes(2, percent_rescinded+10, label = paste0(round(percent_rescinded, 1), "%")),
color = "black")+
labs(y = "\nPercent of Offers Rescinded", x = "\nUS Region")+
#scale_y_continuous(limits = c(0,20), expand = c(0,0))+
my_theme_horiz+
right_margin
fig2ABC <- plot_grid(fig2A, fig2B, fig2C, labels = c('A', 'B', 'C'),
label_size = 18,
nrow = 1, rel_widths = c(.75, 1, 1))
fig2DE <- plot_grid(fig2D, fig2E, labels = c('D', 'E'),
label_size = 18,
nrow = 1, rel_widths = c(.5, 1))
plot_grid(fig2ABC, fig2DE,
label_size = 18, #rel_heights = c(1, 1.25),
nrow = 2)
fig2AB <- plot_grid(fig2A, fig2C, labels = c('A', 'B'),
label_size = 18,
nrow = 1, rel_widths = c(.75, 1))
fig2DE <- plot_grid(fig2D, fig2E, labels = c('D', 'E'),
label_size = 18,
nrow = 1, rel_widths = c(.5, 1))
plot_grid(fig2AB, fig2C, fig2DE,
labels = c('', 'C', ''),
label_size = 18, #rel_heights = c(1, 1.25),
nrow = 2)
fig2AB <- plot_grid(fig2A, fig2C, labels = c('A', 'B'),
label_size = 18,
nrow = 1, rel_widths = c(.75, 1))
fig2DE <- plot_grid(fig2D, fig2E, labels = c('D', 'E'),
label_size = 18,
nrow = 1, rel_widths = c(.5, 1))
plot_grid(fig2AB, fig2C, fig2DE,
labels = c('', 'C', ''),
label_size = 18, #rel_heights = c(1, 1.25),
nrow = 3)
plot_grid(fig2AB, fig2B, fig2DE,
labels = c('', 'C', ''),
label_size = 18, #rel_heights = c(1, 1.25),
nrow = 3)
ggsave("Figure_2.png", device = 'png', units = "in", scale = 1.75,
path = 'figures', width = 7.5, height = 6.8)
fig2B <- get_plot_summary(data = fig2_data,
x = "research_category", y = "covid_offers_rescinded") %>%
ggplot(aes(x = research_category, y = percent_res, fill = research_category))+
geom_col()+
#geom_text(aes(label = r), position = position_dodge(width = 0.9), hjust = -0.25)+
coord_flip()+
scale_fill_manual(values = cbPalette)+
geom_hline(yintercept = overall_percent_rescinded, linetype="dashed", color = "black")+
geom_text(aes(5, overall_percent_rescinded+1,
label = paste0(round(overall_percent_rescinded, 1), "%")),
color = "black")+
labs(y = "\nOverall Percent of Offers Rescinded", x = "\nReported Research Category")+
scale_y_continuous(limits = c(0,25), expand = c(0,0))+
my_theme
fig2AB <- plot_grid(fig2A, fig2C, labels = c('A', 'B'),
label_size = 18,
nrow = 1, rel_widths = c(.75, 1))
fig2DE <- plot_grid(fig2D, fig2E, labels = c('D', 'E'),
label_size = 18,
nrow = 1, rel_widths = c(.5, 1))
plot_grid(fig2AB, fig2B, fig2DE,
labels = c('', 'C', ''),
label_size = 18, #rel_heights = c(1, 1.25),
nrow = 3)
ggsave("Figure_2.png", device = 'png', units = "in", scale = 1.75,
path = 'figures', width = 7.5, height = 6.8)
source("~/Desktop/Kozik_COVID-19_PLoSOne_2022/code/figures/figure_2.R")
source("~/Desktop/Kozik_COVID-19_PLoSOne_2022/code/figures/figure_2.R")
source("~/Desktop/Kozik_COVID-19_PLoSOne_2022/code/figures/figure_2.R")
View(PUI_RI_rescinded)
source("~/Desktop/Kozik_COVID-19_PLoSOne_2022/code/figures/figure_2.R")
source("~/Desktop/Kozik_COVID-19_PLoSOne_2022/code/figures/figure_2.R")
source("~/Desktop/Kozik_COVID-19_PLoSOne_2022/code/figures/figure_2.R")
source("~/Desktop/Kozik_COVID-19_PLoSOne_2022/code/figures/figure_2.R")
source("~/Desktop/Kozik_COVID-19_PLoSOne_2022/code/figures/figure_2.R")
source("~/Desktop/Kozik_COVID-19_PLoSOne_2022/code/figures/figure_2.R")
source("~/Desktop/Kozik_COVID-19_PLoSOne_2022/code/figures/figure_2.R")
source("~/Desktop/Kozik_COVID-19_PLoSOne_2022/code/figures/figure_2.R")
source("~/Desktop/Kozik_COVID-19_PLoSOne_2022/code/figures/figure_2.R")
source("~/Desktop/Kozik_COVID-19_PLoSOne_2022/code/figures/figure_2.R")
source("code/figures/statistics.R")
stats_demo_data <- res_demo_data %>%
select(id, covid_offers_rescinded, adjusted_gender, peer, research_category)
#Figure 2 -----
#Fig A
gen_chi <- fisher.test(table(stats_demo_data$adjusted_gender,
stats_demo_data$covid_offers_rescinded))
#Fig B
cat_chi <- fisher.test(table(stats_demo_data$research_category,
stats_demo_data$covid_offers_rescinded))
#Fig C
re_chi <- fisher.test(table(stats_demo_data$peer,
stats_demo_data$covid_offers_rescinded))
#Fig D
pui_count <- PUI_RI_rescinded %>% select(PUI_RI, n_rescinded, nr) %>%
remove_rownames %>% column_to_rownames(var="PUI_RI")
pui_chi <- fisher.test(pui_count)
#
##Fig F
us_reg_count <- per_US_region_rescinded %>% select(US_region, n_rescinded, nr) %>%
remove_rownames %>% column_to_rownames(var="US_region")
us_reg_chi <- fisher.test(us_reg_count)
fig2_chi_list <- c("gen_chi", "cat_chi",
"re_chi", "pui_chi",
"us_reg_chi")
fig2_plot_list <- c('2A', '2B',
'2C', '2D', '2F')
fig2_chi_tbl_raw <- map2_df(fig2_chi_list, fig2_plot_list, get_wilcox_tbl)
fig2_chi_tbl <- fig2_chi_tbl_raw %>%
spread(key = attribute, value = value)
write_csv(fig2_chi_tbl, file = paste0("figures/fig2abcdf_chi_stats_",
Sys.Date(),".csv"))
